/**
 *
 * @module     theme_mb2nl
 * @copyright  2017 - 2021 Mariusz Boloz (https://mb2themes.com)
 * @license    Commercial https://themeforest.net/licenses
 */ define(["jquery","core/ajax","core/notification"],function(e,r,o){var s=function(e){this.registerEventListeners()};return s.prototype._getCourse=function(s){var t=e(s.currentTarget).hasClass("course-popover")?e(s.currentTarget):e(s.currentTarget).parent(),a=e(s.currentTarget).hasClass("course-popover")?e(s.currentTarget):e(".popover-"+t.data("course"));if(this._createPopover(t),this._setPosition(t),this._showPopover(t),a.html()||t.hasClass("course-popover"))return null;r.call([{methodname:"theme_mb2nl_course_quickview",args:{course:t.data("course")},done:this._handleResponse.bind(this),fail:o.exception}])},s.prototype._hideCourse=function(r){var o=e(r.currentTarget).hasClass("course-popover")?e(r.currentTarget):e(r.currentTarget).parent();if(o.hasClass("course-popover"))return o.removeClass("open"),null;e(".popover-"+o.data("course")).removeClass("open")},s.prototype._handleResponse=function(r){var o=e(".popover-"+r.courseid+" .course-popover-inner");setTimeout(function(){o.append(r.course),o.removeClass("loading")},200)},s.prototype._createPopover=function(r){if(e(".popover-"+r.attr("data-course")).length||r.hasClass("course-popover"))return null;var o='<div class="course-popover popover-'+r.attr("data-course")+'"><div class="course-popover-inner loading"><div class="span1"></div><div class="span2"></div></div><div class="popover-arrow"></div></div>';e("body").append(o)},s.prototype._setPosition=function(r){if(r.hasClass("course-popover"))return null;var o=e(window),s=e(".popover-"+r.attr("data-course")),t=15,a=e("body").hasClass("dir-rtl"),i=r.closest(".mb2-pb-content-list"),n=r.find(">div");i.hasClass("swiper-wrapper")||i.hasClass("gutter-none")?t=0:i.hasClass("gutter-thin")&&(t=5),s.removeClass("arrtop"),s.removeClass("arrleft"),s.removeClass("arrright");var p=r.offset().top,c=r.offset().left-s.width()+t,u=r.offset().left+r.width()+t,l={left:c,top:p},d={left:u,top:p};if(r.width()+s.width()+t>o.width()){var v=t+r.offset().left;v+s.width()>o.width()&&(v=o.width()-s.width()-t),s.css({left:v,top:p+n.height()}),s.addClass("arrtop")}else!a&&u+s.width()>o.width()?(s.css(l),s.addClass("arrright")):a&&c<0?(s.css(d),s.addClass("arrleft")):a?(s.css(l),s.addClass("arrright")):(s.css(d),s.addClass("arrleft"))},s.prototype._showPopover=function(r){(r.hasClass("course-popover")?r:e(".popover-"+r.attr("data-course"))).addClass("open")},s.prototype.registerEventListeners=function(){var r=e(document);r.on("mouseenter",".theme-course-item-inner,.course-popover",this._getCourse.bind(this)),r.on("mouseleave",".theme-course-item-inner,.course-popover",this._hideCourse.bind(this))},s});
